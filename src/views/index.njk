{% extends 'base.njk' %}

{% block main %}
      {% if cities %}
        {% for city in cities %}
          <div class="card">
            <div class="card-image">
              {% if city.image.img.data %}
                <img src="data:{{ city.image.img.contentType }};base64,{{ city.image.img.data.toString('base64') }}", alt="{{ city.name }}">
                {% else %}
                <img src="./public/images/cities/irvine.jpeg">
              {% endif %}
            </div>
            <div class="card-text">
              <span class="date"><h2>{{ city.name }}</h2></span>
              <p>"{{ city.description }}"</p>
            </div>
            <div class="card-stats">
              <div class="stat">
                <div class="value">{{ city.population }}</div>
                <div class="type">population</div>
              </div>
              <div class="stat border">
                {% if city.AHI %}
                  <div class="value">{{ city.AHI }}</div>
                {% else %}
                  <div class="value">null</div>
                {% endif %}
                <div class="type">AHI</div>
              </div>
              <div class="stat">
                {% if city.area %}
                  <div class="value">
                    {{ city.area }}
                    <sup>2</sup>
                  </div>
                {% else %}
                  <div class="value">null</div>
                {% endif %}
                <div class="type">area (m)</div>
              </div>
            </div>
          </div>
        {% endfor %}
      {% endif %}
{% endblock %}

{% block dialog %}
    <dialog id="addCityForm">
      <div class="modalContainer">
        <div id="formHeading">Add a City Category!</div>
        <form action="/" method="POST" enctype="multipart/form-data">
          <input type="text" placeholder="Name" id="cityName" name="cityName" required/>
          <input type="text" placeholder="Description" id="cityDesc" name="cityDesc" />
          <input type="number" placeholder="Population" id="cityPop" name="cityPop" />
          <input type="number" step="any" placeholder="Area" id="cityArea" name="cityArea" />
          <input type="number" placeholder="Average Household Income" id="cityAHI" name="cityAHI" />
          <input type="file" id="cityImg" name="cityImg" class="file-input" />
          <label for="cityImg" class="file-label">
            <i class="fa-solid fa-image"></i>
            &nbsp;Upload Image
          </label>
          <button type="submit">Submit</button>
        </form>
      </div>
    </dialog>
{% endblock %}